(()=>{"use strict";window.addEventListener("contextmenu",(t=>{t.preventDefault()}),!1);const t=document.createElement("canvas"),s=document.querySelector("body"),i=t.getContext("2d");i.strokeStyle="black",i.lineWidth=2,t.width=t.height="450",t.textContent='Извините, ваш браузер не поддерживает "canvas" элемент.',s.appendChild(t);const e=new class{constructor(t){this.ctx=t.getContext("2d"),this.size=0,this.grid=[],this.guesses=[],this.hints={rows:[],columns:[]},this.mouse=function(t){const s={x:null,y:null,isPressed:!1,event:null},{body:{scrollLeft:i,scrollTop:e},documentElement:{scrollLeft:h,scrollTop:r}}=document;return t.addEventListener("touchstart",(t=>{s.isPressed=!0,s.event=t}),!1),t.addEventListener("touchend",(t=>{s.isPressed=!1,s.x=null,s.y=null,s.event=t}),!1),t.addEventListener("touchmove",(l=>{const{offsetLeft:o,offsetTop:n}=t,c=l.touches[0];let a,u;c.pageX||c.pageY?(a=c.pageX,u=c.pageY):(a=c.clientX+i+h,u=c.clientY+e+r),a-=o,u-=n,s.x=a,s.y=u,s.event=l}),!1),s}(t)}generateGrid(t){const s=Array(t*t).fill(0);this.guesses=Array(t*t).fill(0),this.grid=s.map((t=>Math.round(Math.random()))),this.size=t,console.log(Array.from({length:t},((s,i)=>this.grid.slice(i*t,(i+1)*t))))}clearGrid(){this.guesses=this.guesses.map((t=>0))}drawTile(t,s,i){this.ctx.save(),this.ctx.translate(100,100),this.ctx.fillStyle=i,"red"===i?(this.ctx.fillStyle="white",this.ctx.fillRect(t,s,60,60),this.ctx.fillStyle=i,this.ctx.translate(Math.round(30),60),this.ctx.textAlign="center",this.ctx.font="83px Arial",this.ctx.fillText("X",t,s)):this.ctx.fillRect(t,s,60,60),this.ctx.restore()}solve(){this.guesses=[...this.grid],this.update()}isSolved(){for(let t=0;t<this.grid.length;t+=1)if(this.grid[t]!==this.guesses[t])return!1;return!0}update(){this.ctx.clearRect(0,0,this.ctx.width,this.ctx.height),this.render(),this.isSolved()&&alert("Success!")}onMouseDown(t){(()=>{for(let s=0;s<rows;s++)for(let i=0;i<cols;i++){const e=i+s*cols;if(mouse.x>=100+i*(60+this.size)&&mouse.x<=160+i*(60+this.size)&&mouse.y>=100+s*(60+this.size)&&mouse.y<=160+s*(60+this.size))switch(t.button){case 0:this.guesses[e]=1===this.guesses[e]?0:1;break;case 2:this.guesses[e]=2===this.guesses[e]?0:2}}})(),this.update()}render(){const t=60;this.ctx.fillStyle="gray",this.ctx.fillRect(0,0,this.ctx.width,this.ctx.height),this.ctx.fillStyle="black",this.ctx.fillRect(100-this.size,100-this.size,t*this.size+this.size*(this.size+1),t*this.size+this.size*(this.size+1)),this.writeHorizClues(),this.writeVertClues();for(var s=0;s<this.size;s++)for(var i=0;i<this.size;i++){var e=i+s*this.size;0===this.guesses[e]?this.drawTile((t+this.size)*i,(t+this.size)*s,"white"):1===this.guesses[e]?this.drawTile((t+this.size)*i,(t+this.size)*s,"purple"):this.drawTile((t+this.size)*i,(t+this.size)*s,"red")}}writeHorizClues(){var t=100+Math.round(30);console.log(this.hints),null===this.hints.rows&&this.getHintsValues(),this.ctx.save(),this.ctx.font="bold 18px Arial",this.ctx.fillStyle="white";for(var s=0;s<this.hints.rows.length;s++)this.ctx.fillText(this.hints.rows[s],30,t),t+=60+this.size;this.ctx.restore()}writeVertClues(){var t,s=100+Math.round(15);this.ctx.save(),this.ctx.font="bold 18px Arial",this.ctx.fillStyle="white";for(var i=0;i<this.hints.columns.length;i++){var e=this.hints.columns[i];t=32;for(var h=0;h<e.length;)if(this.ctx.fillText(e.charAt(h),s,t),h++," "===e.charAt(h))for(t+=28;" "===e.charAt(h);)h++;s+=60+this.size}this.ctx.restore()}getHintsValues(){for(var t=0;t<this.size;t++){let i="",e=0,h=0;h=t*this.size;for(var s=1;s<this.size-1;s++){for(e=0;0===this.grid[h]&&h<this.size+t*this.size;)h++;for(;1===this.grid[h]&&h<this.size+t*this.size;)e+=1,h++;if(e&&(i+=e+"  "),h>=this.size+t*this.size)break}""===i&&(i="0"),this.hints.rows.push(i)}for(t=0;t<this.size;t++){let i=0,e=t,h="";for(s=1;s<4;s++){for(i=0;0===this.grid[e]&&e<t+this.size*this.size;)e+=this.size;for(;1===this.grid[e]&&e<t+this.size*this.size;)i+=1,e+=this.size;if(i&&(h+=i+"  "),e>=t+this.size*this.size)break}""===h&&(h="0"),this.hints.columns.push(h)}console.log(this.hints)}}(t);e.generateGrid(5),e.getHintsValues(),e.clearGrid(),e.update(),console.log(e.hints)})();